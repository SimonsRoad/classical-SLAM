
## 写在前面
 ORB-SLAM is a versatile and accurate Monocular SLAM solution able to compute in real-time the camera trajectory and a sparse 3D reconstruction of the scene in a wide variety of environments, ranging from small hand-held sequences to a car driven around several city blocks. It is able to close large loops and perform global relocalisation in real-time and from wide baselines.


## 1. ORB-SLAM编译
C++  、 ROS

### 1.1 依赖库

- 多线程 Boost library : launch the different threads of our SLAM system.
    sudo apt-get install libboost-all-dev 
- 图像处理 OpenCV library : manipulate images and features

- 图优化 g2o : use a modified version of g2o to perform optimizations(g2o依赖于Eigen库)
    sudo apt-get install libeigen3-dev

- 回环检测 DBoW2 : use of some components of the DBoW2 and DLib library  for place recognition and feature matching


### 修改成catkin_make方式的ros软件包

- 修改CmakeLists.txt
- 添加package.xml
- 修改 src/ORBextractor.cc 文件
- 修改Thirdparty/g2o/g2o/solvers/linea_solver_eigen.h文件
- catkin_make


## 2. ORB-SLAM 运行测试

###  摄像头单次运行测试
```
run ORB_SLAM node
cd /home/hualong/ssd/coding/ros-SLAM-ws/src/ORB_SLAM
rosrun  ORB_SLAM ORB_SLAM   Data/ORBvoc.txt  Data/Settings.yaml

需要一个发布 /camera/image_raw的单目RGB话题
rosrun uvc_camera uvc_camera_node /image_raw:=/camera/image_raw

rviz 可视化
rosrun rviz rviz -d Data/rviz.rviz

```

###  数据集运行测试
run ORB_SLAM node
cd /home/hualong/ssd/coding/ros-SLAM-ws/src/ORB_SLAM
rosrun  ORB_SLAM ORB_SLAM   Data/ORBvoc.txt  Data/Settings.yaml

rviz 可视化
rosrun rviz rviz -d Data/rviz.rviz

rosbag play --pause Example.bag



## 3. ORB-SLAM 源码分析

### 注释过的源文件
Initializer.cc Initializer.h         ORB_SLAM::Initializer类      用于
FramePublisher.cc FramePublisher.h   ORB_SLAM::FramePublisher类   用于在tracking的过程中，将当前帧在运行中的可视化结果发布给ROS




- 版权打印
ORB-SLAM Copyright (C) 2014 Raul Mur-Artal
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

- 加载词袋模型
Loading ORB Vocabulary. This could take a while.
Vocabulary loaded!

- 相机内参
Camera Parameters: 
- fx: 609.286
- fy: 609.342
- cx: 351.427
- cy: 237.732
- k1: -0.3492
- k2: 0.1363
- p1: 0
- p2: 0
- fps: 30
- color order: RGB (ignored if grayscale)

- ORB特征设置
ORB Extractor Parameters: 
- Number of Features: 1000
- Scale Levels: 8
- Scale Factor: 1.2
- Fast Threshold: 20
- Score: FAST

- Motion Model: Enabled

[ INFO] [1546829312.364902304]: New Map created with 149 points
[ INFO] [1546829314.472854957]: New Map created with 164 points
virtual int g2o::SparseOptimizer::optimize(int, bool): 0 vertices to optimize, maybe forgot to call initializeOptimization()
virtual int g2o::SparseOptimizer::optimize(int, bool): 0 vertices to optimize, maybe forgot to call initializeOptimization()
virtual int g2o::SparseOptimizer::optimize(int, bool): 0 vertices to optimize, maybe forgot to call initializeOptimization()
[ INFO] [1546829323.161239259]: New Map created with 136 points
